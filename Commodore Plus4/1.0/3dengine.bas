NEWSCNCLR10graphic1,1:color4,1:color0,1:color1,6,420scnclr30gx=0:gy=15:gz=200:p=3.14159265359/18040cf=1:cd=050fs=200:dx=140:dy=100:l=2260OPEN8,8,12,"vertex,SEQ,READ"70input#8,c$,d$,h$,u$:c%=val(c$):d%=val(d$):h=val(h$):dimu%(val(u$)):dimsl(val(u$))80dimx%(c%):dimy%(c%):dimz%(c%):dimxi%(val(u$))90dimvx%(c%):dimvy%(c%)100dimoo%(800):dimou%(800):dimoi%(800):dimff%(4250)110char,0,0,"Loading vertices"120FORA=1TOc%:130input#8,x$,y$,z$140x%(a)=val(x$):y%(a)=val(y$):z%(a)=val(z$)150char,0,1,Str$(a)+"/"+Str$(c%)160NEXT170close8:180190goto470200210REM7060220GETKEYA$230ifA$="x"thengx=gx+15240ifA$="y"thengy=gy+15250ifA$="c"thengz=gz+15260270ifA$="b"thengx=gx-15280ifA$="n"thengy=gy-15290ifA$="m"thengz=gz-15300310320IfA$="w"Thendy=dy-20330IfA$="a"Thendx=dx-20340IfA$="d"Thendx=dx+20350IfA$="s"Thendy=dy+20360370IfA$="q"Thenfs=fs+1:380IfA$="e"Thenfs=fs-1:390IfA$="t"Thenl=l+1:400IfA$="g"Thenl=l-1:410IfA$="l"Thenscnclr:goto690420430ifA$="i"Thenchar,0,0,"gx:"+str$(gx)+"dx:"+str$(dx)+"l:"+str$(l)440IfA$="i"Thenchar,0,1,"gy:"+str$(gy)+"dy:"+str$(dy)450IfA$="i"Thenchar,0,2,"gz:"+str$(gz)+"fs:"+str$(fs):goto210460470REM7290480scnclr490500rx=gx*p510ry=gy*p520rz=gz*p530cx=cos(rx):sx=sin(rx)540cy=cos(ry):sy=sin(ry)550cz=cos(rz):sz=sin(rz)560570fornp=1toc%580xp=x%(np)/d%*l590yp=y%(np)/d%*l600zp=z%(np)/d%*l610620gosub1290630vx%(np)=dx+(xp*fs)/(zp+fs)640vy%(np)=dy+(yp*fs)/(zp+fs)650draw1,vx%(np),vy%(np)660next670char,0,0,"!":goto210680690REM7600700OPEN8,8,12,"planes,SEQ,READ"710i=1:fr=0:ff=0:ii=0720FORA=1TOh730input#8,v740u%(i)=v750ifv<>0theni=i+1:760ifv=0then fr=fr+1:gosub790:i=1770NEXT780close8:gosub1500:goto210790REM11000800char,0,0,"Find Faces"810g=3:p0=u%(g-2)820REM11003830p1=u%(g-2):p2=u%(g-1):p3=u%(g)840gosub1290850860xp=x%(p1)/d%870yp=y%(p1)/d%880zp=z%(p1)/d%890gosub1290900x1=xp:y1=yp:z1=zp910920xp=x%(p2)/d%930yp=y%(p2)/d%940zp=z%(p2)/d%950gosub1290960x2=xp:y2=yp:z2=zp970980xp=x%(p3)/d%990yp=y%(p3)/d%1000zp=z%(p3)/d%1010gosub12901020x3=xp:y3=yp:z3=zp10301040lx=x2-x1:px=x3-x11050ly=y2-y1:py=y3-y11060lz=z2-z1:pz=z3-z110701080xn=(ly*pz)-(lz*py)1090yn=(lz*px)-(lx*pz)1100zn=(lx*py)-(ly*px)11101120remle=sqr(xn*xn+yn*yn+zn*zn)1130remifle<>0thenxn=xn/le:yn=yn/le:zn=zn/le1140remw=xn*x1+yn*y1+zn*z11150ifzn>0thenreturn1160gosub1350: gosub 2390:char,0,3,"ar:"+Str$(ar)+"      "1161if ar<=2 then return1170ifg=3thendrawcf,x1,y1tox2,y2tox3,y3:elsedrawcf,x1,y1tox2,y2tox3,y31180g=g+11190ifu%(g)<>0thengoto820:elsedrawcf,x2,y2tox3,y3tovx%(p0),vy%(p0)1200ff=ff+1:char,0,1,"f:"+Str$(ff)1210fv=fv+g:char,0,2,"v:"+Str$(fv)1220oo%(ff)=(z1+z2+z3):ou%(ff)=fr:oi%(ff)=ii+1:1230foryy=1tog-11240ff%(ii+yy)=u%(yy)1250next1260ff%(ii+g)=fr*(-1):ii=ii+g1270return12801290REM400001300yt=yp:yp=cx*yt-sx*zp:zp=sx*yt+cx*zp1310xt=xp:xp=cy*xt+sy*zp:zp=-sy*xt+cy*zp1320xt=xp:xp=cz*xt-sz*yp:yp=sz*xt+cz*yp1330return13401350REM400041360x1=vx%(p1):y1=vy%(p1)1370x2=vx%(p2):y2=vy%(p2)1380x3=vx%(p3):y3=vy%(p3)1390return14001410REM400201420remsort1430fori=1toff-11440char,0,1,str$(i)+"/"+str$(ff)1450forj=i+1toff1460ifoo%(j)>oo%(i)thent=ou%(i):ou%(i)=ou%(j):ou%(j)=t:t=oi%(i):oi%(i)=oi%(j):oi%(j)=t1470ifoo%(j)>oo%(i)thent=oo%(i):oo%(i)=oo%(j):oo%(j)=t1480nextj:nexti:return14901500REM419991510remZeichnesichtbarefaces1520char,0,0,"Sort":char,0,2,""1530gosub14101540scnclr15501560forj=1toff1570fori=oi%(j)tofv1580u%(k)=ff%(i)1590ifff%(i)>0thenk=k+11600if(ff%(i)<0)thenk=11610if(ff%(i)<0)and(abs(ff%(i))=ou%(j))thengosub1670:goto16301620nexti1630REM421111640nextj1650return16601670REM500001680remDrawface1690g=3:p0=u%(g-2)1700REM510031710p1=u%(g-2):p2=u%(g-1):p3=u%(g)1720gosub129017301740xp=x%(p1)/d%1750yp=y%(p1)/d%1760zp=z%(p1)/d%1770gosub12901780x1=xp:y1=yp:z1=zp17901800xp=x%(p2)/d%1810yp=y%(p2)/d%1820zp=z%(p2)/d%1830gosub12901840x2=xp:y2=yp:z2=zp18501860xp=x%(p3)/d%1870yp=y%(p3)/d%1880zp=z%(p3)/d%1890gosub12901900x3=xp:y3=yp:z3=zp19101920gosub13501930g=g+1:1940ifu%(g)>0thengoto1700:elsegosub19701950return19601970REM612001980n=g-1:it=i:jt=j:tx=dx:ty=dy:tk=k:yn=200:yx=0:ug=u%(g):u%(g)=u%(1)19902000Fori=1Ton2010ifvy%(U%(i))<ynThenyn=vy%(U%(i))2020Ifvy%(U%(i))>yxThenyx=vy%(U%(i))2030dy=vy%(U%(i+1))-vy%(U%(i))2040dx=vx%(U%(i+1))-vx%(U%(i))2050Ifdy=0Thensl(i)=1.02060Ifdx=0Thensl(i)=0.02070If(dy<>0)And(dx<>0)Thensl(i)=dx/dy2080Next20902100Fory=ynToyx-12110k=021202130Fori=1Ton2140If((vy%(U%(i))<=y)And(vy%(U%(i+1))>y))Thengosub23502150If((vy%(U%(i))>y)And(vy%(U%(i+1))<=y))Thengosub23502160Next21702180Forj=0Tok-22190Fori=0Tok-22200Ifxi(i)>xi(i+1)Thent=xi(i):xi(i)=xi(i+1):xi(i+1)=t2210Next2220Next22302240Fori=0Tok-1step22250drawcd,xi(i)+1,yTOxi(i+1)-1,y2260Next2270Next22802290Fori=1Ton2300drawcf,vx%(U%(i)),vy%(U%(i))tovx%(U%(i+1)),vy%(U%(i+1))2310Next23202330i=it:j=jt:dx=tx:dy=ty:k=tk:u%(g)=ug2340return2350REM616002360xi(k)=((vx%(U%(i))+sl(i)*(y-vy%(U%(i)))))2370k=k+12380return2390 ar = 02391 aj = i-1 2392 for ai=1 to i-12393 ar=ar+(vx%(U%(aj))+vx%(U%(ai)))*(vy%(U%(aj))-vy%(U%(ai)))2394 aj=ai2395 next ai2396 ar=abs(ar/2)2397 return RUN